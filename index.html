<!DOCTYPE html>
<html>
  <head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <link href='https://fonts.googleapis.com/css?family=Architects+Daughter' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" type="text/css" href="stylesheets/stylesheet.css" media="screen">
    <link rel="stylesheet" type="text/css" href="stylesheets/pygment_trac.css" media="screen">
    <link rel="stylesheet" type="text/css" href="stylesheets/print.css" media="print">

    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <title>Getcartr by chrisbrunsdon</title>
  </head>

  <body>
    <header>
      <div class="inner">
        <h1>Getcartr</h1>
        <h2>Front end for rcartogram</h2>
        <a href="https://github.com/chrisbrunsdon/getcartr" class="button"><small>View project on</small> GitHub</a>
      </div>
    </header>

    <div id="content-wrapper">
      <div class="inner clearfix">
        <section id="main-content">
          <h1>
<a id="a-front-end-for-the-rcartogram-package" class="anchor" href="#a-front-end-for-the-rcartogram-package" aria-hidden="true"><span class="octicon octicon-link"></span></a>A Front End For the Rcartogram Package</h1>

<p>This demonstrates the <em>getcartr</em> package. Firstly load it:</p>

<pre><code>library(getcartr)
</code></pre>

<p><code>quick.carto</code> gives you a cartogram very quickly:</p>

<pre><code>data(georgia)
georgia.carto &lt;- quick.carto(georgia,georgia2$TotPop90)
par(mfrow=c(1,2),mar=c(0.5,0.5,3,0.5))
plot(georgia2)
title("Original Projection")
plot(georgia.carto)
title("Cartogram Projection")
</code></pre>

<p><img src="https://raw.githubusercontent.com/chrisbrunsdon/getcartr/master/demo_files/figure-markdown_strict/unnamed-chunk-2-1.png" alt=""></p>

<p>and plot the transformation mesh:</p>

<pre><code># Load an example SpatialPolygonsDataFrame from GISTools
data(georgia)
# Create the cartogram.  TotPop90 contains 1990 county populations
# "georgia2" is used as it has a plane projection coordinate system
georgia.carto &lt;- quick.carto(georgia2,georgia2$TotPop90)
# Draw the mesh
mesh(georgia.carto)
</code></pre>

<p><img src="https://raw.githubusercontent.com/chrisbrunsdon/getcartr/master/demo_files/figure-markdown_strict/unnamed-chunk-3-1.png" alt=""></p>

<p>and apply the cartogram transform to new sets of points:</p>

<pre><code># Create a set of 25 points from northwest to southeast corners
xl &lt;- seq(1419424,939220.7,l=25)
yl &lt;- seq(905508,1405900,l=25)
pset &lt;- readWKT(paste("MULTIPOINT(",paste(apply(cbind(xl,yl),1,function(x) paste("(",x[1],x[2],")")),collapse=","),")"))
#' #  Transform it
pset.carto &lt;- warp.points(pset,georgia.carto)

# Plot the original points
par(mfrow=c(1,2),mar=c(0.5,0.5,3,0.5))
plot(georgia2,border='grey'); plot(pset, add=T, col='red')
title('Original projection')

# Plot in cartogram space
plot(georgia.carto,border='grey'); plot(pset.carto, add=T, col='red')
title('Cartogram projection')
</code></pre>

<p><img src="https://raw.githubusercontent.com/chrisbrunsdon/getcartr/master/demo_files/figure-markdown_strict/unnamed-chunk-4-1.png" alt=""></p>

<p>or lines:</p>

<pre><code># Create a line from southwest to northeast corners,  with 100 segments
xl &lt;- seq(939220.7,1419424,l=100)
yl &lt;- seq(905508,1405900,l=100)
aline &lt;- readWKT(paste("LINESTRING(",paste(apply(cbind(xl,yl),1,function(x) paste(x[1],x[2])),collapse=","),")"))

#  Transform it
aline.carto &lt;- warp.lines(aline,georgia.carto)

# Plot the original line
par(mfrow=c(1,2),mar=c(0.5,0.5,3,0.5))
plot(georgia2,border='grey'); plot(aline, add=T, col='red')
title('Original projection')

# Plot in cartogram space
plot(georgia.carto,border='grey'); plot(aline.carto, add=T, col='red')
title('Cartogram projection')
</code></pre>

<p><img src="https://raw.githubusercontent.com/chrisbrunsdon/getcartr/master/demo_files/figure-markdown_strict/unnamed-chunk-5-1.png" alt=""></p>

<p>... or areas.</p>

<pre><code># Create a pseudocircle with 100 segments
xl &lt;- cos(seq(0,2*pi,l=100))*100000 + 1239348
yl &lt;- sin(seq(0,2*pi,l=100))*100000 + 1093155
circ &lt;- readWKT(paste("MULTIPOLYGON(((",paste(apply(cbind(xl,yl),1,function(x) sprintf("%7.0f %7.0f",x[1],x[2])),collapse=","),")))"))
#' #  Transform it
circ.carto &lt;- warp.polys(circ,georgia.carto)

# Plot the original circle
par(mfrow=c(1,2),mar=c(0.5,0.5,3,0.5))
plot(georgia2,border='grey'); plot(circ, add=T, col=rgb(1,0,0,0.4), border=NA)
title('Original projection')

# Plot in cartogram space
plot(georgia.carto,border='grey'); plot(circ.carto, add=T, col=rgb(1,0,0,0.4), border=NA)
title('Cartogram projection')
</code></pre>

<p><img src="https://raw.githubusercontent.com/chrisbrunsdon/getcartr/master/demo_files/figure-markdown_strict/unnamed-chunk-6-1.png" alt=""></p>

<h1>
<a id="alternative-approach" class="anchor" href="#alternative-approach" aria-hidden="true"><span class="octicon octicon-link"></span></a>Alternative approach</h1>

<p>Use the <code>carto.transform</code> function to create a new <em>function</em> to apply
the cartogram transform to any shapefile. This function automatically
determines whether the input object is <code>SpatialPolygons*</code>,
<code>SpatialLines*</code> or <code>SpatialPoints*</code>. Here the Newhaven data in
<code>GISTools</code> will be used:</p>

<pre><code># Get the newhaven data
require(GISTools)
data(newhaven)
# Plot the untransformed data
par(mfrow=c(1,2),mar=c(0.5,0.5,3,0.5))
plot(blocks) # Census blocks
plot(roads,col='lightgrey',add=TRUE) # Roads
plot(burgres.f,col='darkred',pch=16,add=TRUE) # Forced entry burglaries

# Create the cartogram transform function
to.carto &lt;- carto.transform(blocks,blocks$POP1990)

# Now create a cartogram version of the map
# Plot the blocks carto
plot(to.carto(blocks))
# Add roads,  transformed to cartogram space
plot(to.carto(roads),add=TRUE,col='lightgrey')
# Add forced entry residential burglaries, transformed to cartogram space
plot(to.carto(burgres.f),add=TRUE,col='darkred',pch=16)
</code></pre>

<p><img src="https://raw.githubusercontent.com/chrisbrunsdon/getcartr/master/demo_files/figure-markdown_strict/unnamed-chunk-7-1.png" alt=""></p>
        </section>

        <aside id="sidebar">
          <a href="https://github.com/chrisbrunsdon/getcartr/zipball/master" class="button">
            <small>Download</small>
            .zip file
          </a>
          <a href="https://github.com/chrisbrunsdon/getcartr/tarball/master" class="button">
            <small>Download</small>
            .tar.gz file
          </a>

          <p class="repo-owner"><a href="https://github.com/chrisbrunsdon/getcartr"></a> is maintained by <a href="https://github.com/chrisbrunsdon">chrisbrunsdon</a>.</p>

          <p>This page was generated by <a href="https://pages.github.com">GitHub Pages</a> using the Architect theme by <a href="https://twitter.com/jasonlong">Jason Long</a>.</p>
        </aside>
      </div>
    </div>

  
  </body>
</html>
